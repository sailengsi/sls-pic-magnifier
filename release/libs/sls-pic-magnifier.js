!function(t,e,s){"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(e):s[t]=e()}("SlsPicMagnifier",function(){var t=function(){};return t.prototype={constructor:t,version:"1.0.0",debug:!0,lg:function(t,e){return this.debug&&console[e?e:"log"](t),this},extend:function(t,e){if(e&&e.constructor===Object)for(var s in e)t[s]=e[s];return t},isDom:function(t){return"object"==typeof HTMLElement?t instanceof HTMLElement:t&&"object"==typeof t&&1===t.nodeType&&"string"==typeof t.nodeName},toDom:function(t){return"string"==typeof t?document.querySelector(t):this.isDom(t)?t:null},setCss:function(t,e){for(var s in e)t.style[s]=e[s];return this},getSize:function(t){return{width:t.offsetWidth,height:t.offsetHeight}},getOffset:function(t){return t.getBoundingClientRect?this.getOffsetRect(t):this.getOffsetSum(t)},getOffsetSum:function(t){for(var e=0,s=0;t;)e+=parseInt(t.offsetTop),s+=parseInt(t.offsetLeft),t=t.offsetParent;return{top:e,left:s}},getOffsetRect:function(t){var e=t.getBoundingClientRect(),s=document.body,i=document.documentElement,o=window.pageYOffset||i.scrollTop||s.scrollTop,n=window.pageXOffset||i.scrollLeft||s.scrollLeft,r=i.clientTop||s.clientTop||0,h=i.clientLeft||s.clientLeft||0,c=e.top+o-r,f=e.left+n-h;return{top:Math.round(c),left:Math.round(f)}},getMousePoint:function(t){var e=t||window.event,s=document.documentElement.scrollLeft||document.body.scrollLeft,i=document.documentElement.scrollTop||document.body.scrollTop,o=e.pageX||e.clientX+s,n=e.pageY||e.clientY+i;return{left:o,top:n}},setDefault:function(t){var t=t||window.event;return t.stopPropagation(),t.preventDefault(),this},allCss:{sourceImgContainerCss:{width:"260px",position:"relative","float":"left",padding:"0px"},sourImgCss:{display:"block",width:"100%"},focusPointContainerCss:{width:"50px",height:"50px",display:"block",position:"absolute",top:"0px",left:"0px",filter:"alpha(opacity=50)",mozOpacity:"0.5",opacity:"0.5",cursor:"move",zIndex:"101",background:"#000"},showImgContainerCss:{width:"200px",height:"200px",background:"#000","float":"left",overflow:"hidden",position:"relative",left:"20px"},maxImgCss:{position:"absolute",left:"0px",top:"0px"}},mergeCss:function(t){if(t&&t.constructor===Object)for(var e in t)this.allCss[e]&&(this.allCss[e]=this.extend(this.allCss[e],t[e]));return this},laodImg:function(t,e){var s=new Image;s.src=t,s.onload=function(){e&&e.call(this)}},updateCss:function(){return this.setCss(this.soureImgContainerEle,this.allCss.sourceImgContainerCss).setCss(this.sourceImgEle,this.allCss.sourImgCss).setCss(this.focusPointEle,this.allCss.focusPointContainerCss).setCss(this.showImgEle,this.allCss.showImgContainerCss).setCss(this.maxImgEle,this.allCss.maxImgCss),this},initDom:function(t,e){return e||(this.soureImgContainerEle=this.toDom(this.settings.sourceImgSelector)),this.soureImgContainerEle.innerHTML='<div class="focusPointContainer"></div> <img class="sourceImg" src="'+t+'">',e||(this.showImgEle=this.toDom(this.settings.showImgSelector)),this.showImgEle.innerHTML='<img class="maxImg" src="'+t+'">',this.maxImgEle=this.toDom(".maxImg"),this.sourceImgEle=this.toDom(".sourceImg"),this.focusPointEle=this.toDom(".focusPointContainer"),this},updateImg:function(t,e){if(t===this.imgSrc&&!e)return this;this.imgSrc=t;var s=this;this.initDom(t,!0).laodImg(t,function(){s.updateCss().initData().bindEvent()})},initData:function(){return this.sourceImgContainer={ele:this.soureImgContainerEle,offset:this.getOffset(this.soureImgContainerEle),size:this.getSize(this.soureImgContainerEle)},this.maxImg={ele:this.maxImgEle,offset:this.getOffset(this.maxImgEle),size:this.getSize(this.maxImgEle)},this.scale=this.sourceImgContainer.size.width/this.maxImg.size.width,this.focusPointContainer={ele:this.focusPointEle,offset:this.getOffset(this.focusPointEle),size:this.getSize(this.focusPointEle)},this.showImgContainer={ele:this.showImgEle,offset:{},size:{width:this.focusPointContainer.size.width/this.scale,height:this.focusPointContainer.size.height/this.scale}},this.focusPointFixed={minLeft:this.sourceImgContainer.offset.left+this.focusPointContainer.size.width/2,maxLeft:this.sourceImgContainer.offset.left+this.sourceImgContainer.size.width-this.focusPointContainer.size.width/2,minTop:this.sourceImgContainer.offset.top+this.focusPointContainer.size.height/2,maxTop:this.sourceImgContainer.offset.top+this.sourceImgContainer.size.height-this.focusPointContainer.size.height/2},this.setCss(this.showImgContainer.ele,{width:this.showImgContainer.size.width+"px",height:this.showImgContainer.size.height+"px"}),this},renderData:function(t){var e=this;return this.settings=t,this.imgSrc=t.imgSrc,this.initDom(this.imgSrc).mergeCss(t.css||{}).laodImg(this.imgSrc,function(){e.updateCss().initData().bindEvent()}),this},bindEvent:function(){var t=this;t.sourceImgContainer.ele.onmousemove=function(e){t.setDefault(e);var s=t.getMousePoint(e),i={left:s.left-t.sourceImgContainer.offset.left-t.focusPointContainer.size.width/2+"px",top:s.top-t.sourceImgContainer.offset.top-t.focusPointContainer.size.height/2+"px"};s.left<t.focusPointFixed.minLeft&&(i.left="0px"),s.left>t.focusPointFixed.maxLeft&&(i.left=t.sourceImgContainer.size.width-t.focusPointContainer.size.width+"px"),s.top<t.focusPointFixed.minTop&&(i.top="0px"),s.top>t.focusPointFixed.maxTop&&(i.top=t.sourceImgContainer.size.height-t.focusPointContainer.size.height+"px"),t.setCss(t.focusPointContainer.ele,i).setCss(t.maxImg.ele,{left:-(parseInt(i.left)/t.scale)+"px",top:-(parseInt(i.top)/t.scale)+"px"})},t.sourceImgContainer.ele.onmousedown=function(e){t.setDefault(e)}},checkOptions:function(t){return t&&t.constructor===Object?t.sourceImgSelector?t.showImgSelector?t.imgSrc?!0:(this.lg("对象参数必须包含属性imgSrc,必须是字符串。","error"),!1):(this.lg("对象参数必须包含属性showImgSelector,可以是选择器或者DOM对象。","error"),!1):(this.lg("对象参数必须包含属性sourceImgSelector,可以是选择器或者DOM对象。","error"),!1):(this.lg("必须传入一个对象参数。","error"),!1)},init:function(t){return this.checkOptions(t)?void this.renderData(t):this}},new t},this);